<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Guess The Number</title>

<style>
/* ---------- GLOBAL ---------- */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  background: black;
  overflow: hidden;
  font-family: monospace;
  color: #00ff00;
}

/* ---------- MATRIX BACKGROUND ---------- */
canvas {
  position: fixed;
  top: 0;
  left: 0;
  z-index: -1;
}

/* ---------- GAME BOX ---------- */
.game-box {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(0, 0, 0, 0.75);
  border: 2px solid #00ff00;
  padding: 30px;
  text-align: center;
  transition: 0.3s;
}

.game-box:hover {
  box-shadow: 0 0 30px #00ff00;
  border-color: #00ffaa;
}

h2 {
  margin-bottom: 15px;
}

input {
  padding: 8px;
  width: 180px;
  background: black;
  color: #00ff00;
  border: 1px solid #00ff00;
  outline: none;
  text-align: center;
}

button {
  margin-top: 10px;
  padding: 8px 20px;
  background: black;
  color: #00ff00;
  border: 1px solid #00ff00;
  cursor: pointer;
  transition: 0.3s;
}

button:hover {
  background: #00ff00;
  color: black;
}

#restart {
  display: none;
  margin-left: 10px;
}

#result {
  margin-top: 15px;
  font-size: 18px;
}
</style>
</head>

<body>

<canvas id="matrix"></canvas>

<div class="game-box">
  <h2>Guess Number (1‚Äì15)</h2>

  <input type="number" id="num" placeholder="Enter number">
  <br>
  <button onclick="play()">Try</button>
  <button id="restart" onclick="restart()">Start Game</button>

  <p id="result"></p>
</div>

<script>
/* ================= BACKEND URL ================= */
const API = "http://localhost:9090/guess";

/* ================= GAME LOGIC ================= */
function play() {
  let value = document.getElementById("num").value;

  fetch(API + "?user=" + value)
    .then(res => res.text())
    .then(msg => {
      const result = document.getElementById("result");

      if (msg === "WIN") {
        result.innerText = "üéâ YOU WIN!";
        endGame();
      } else if (msg === "LOSE") {
        result.innerText = "üò¢ YOU LOSE!";
        endGame();
      } else {
  result.innerText = "‚ùó " + msg;
}
    });
}

function endGame() {
  document.getElementById("restart").style.display = "inline";
}

function restart() {
  location.reload();
}

/* ================= MATRIX EFFECT ================= */
const canvas = document.getElementById("matrix");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const chars = "0123456789";
const fontSize = 14;
const columns = canvas.width / fontSize;
const drops = [];

for (let i = 0; i < columns; i++) {
  drops[i] = Math.random() * canvas.height;
}

function drawMatrix() {
  ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  ctx.fillStyle = "#00ff00";
  ctx.font = fontSize + "px monospace";

  for (let i = 0; i < drops.length; i++) {
    const text = chars[Math.floor(Math.random() * chars.length)];
    ctx.fillText(text, i * fontSize, drops[i]);

    drops[i] += fontSize;

    if (drops[i] > canvas.height && Math.random() > 0.98) {
      drops[i] = 0;
    }
  }
}

setInterval(drawMatrix, 50);

/* ================= RESIZE FIX ================= */
window.onresize = () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
};
</script>

</body>
</html>
